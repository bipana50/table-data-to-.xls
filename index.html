<!DOCTYPE html>
<html>
  <head></head>
  <body>
    <input
      type="button"
      id="btnExport"
      value=" Export Table data into Excel "
    />
    <br />
    <br />
    <div id="dvData">
      <table>
        <tr>
          <th>Column One</th>
          <th>Column Two</th>
          <th>Column Three</th>
        </tr>
        <tr>
          <td>row1 Col1</td>
          <td>row1 Col2</td>
          <td>row1 Col3</td>
        </tr>
        <tr>
          <td>row2 Col1</td>
          <td>row2 Col2</td>
          <td>row2 Col3</td>
        </tr>
        <tr>
          <td>row3 Col1</td>
          <td>row3 Col2</td>
          <td>
            <a href="http://www.jquery2dotnet.com/"
              >http://www.jquery2dotnet.com/</a
            >
          </td>
        </tr>
      </table>
    </div>
  </body>
  <script>
    document
      .querySelector("#btnExport")
      .addEventListener("click", function (e) {
          //creating a temporary HTML link element (they support setting file names)
        var a = document.createElement('a');
        //getting data from our div that contains the HTML table
        var data_type = 'data:application/vnd.ms-excel';
        var table_div = document.getElementById('dvData');
        var table_html = table_div.outerHTML.replace(/ /g, '%20');
        a.href = data_type + ', ' + table_html;
        //setting the file name
        a.download = 'exported_table_' + '.xls';
        //triggering the function
        a.click();
        //just in case, prevent default behaviour
        e.preventDefault();
        // // console.log(document.querySelector("#dvData").innerHTML);
        // window.open(
        //   "data:application/vnd.ms-excel," +
        //     document.querySelector("#dvData").innerHTML
        // );
        // e.preventDefault();
      });
  </script>
</html>